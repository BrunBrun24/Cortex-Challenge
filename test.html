<!DOCTYPE html>
<html dir="ltr" lang="fr-FR">

<head>
    <meta charset="UTF-8">
    <title>Pyodide Example</title>
    <!-- Charger Pyodide -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.17.0/full/pyodide.js"></script>
    <!-- Charger CodeMirror -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/codemirror.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/mode/python/python.min.js"></script>
</head>

<body>
    <h1>CORTEX CHALLENGE</h1>
    <!-- Couleur -->
    <textarea id="code1" cols="80" rows="10" style="display:none">
    </textarea>
    <div id="editor1"></div>
    <button onclick="runCode1()">Exécuter le code</button>
    <pre id="output1"></pre>

    <!-- Réflexion -->
    <textarea id="code2" cols="80" rows="10" style="display:none">
    </textarea>
    <div id="editor2"></div>
    <button onclick="runCode2()">Exécuter le code</button>
    <pre id="output2"></pre>

    <script>
        const editor1 = CodeMirror(document.getElementById('editor1'), {
            value: document.getElementById('code1').value,
            mode: 'python',
            lineNumbers: true
        });

        async function runCode1() {
            // Charger Pyodide
            await loadPyodide({ indexURL: "https://cdn.jsdelivr.net/pyodide/v0.17.0/full/" });

            // Obtenir le code Python de l'éditeur
            const code = editor1.getValue();

            // Exécuter le code Python
            pyodide.runPython(code);

            // Afficher la sortie dans la balise <pre> prévue à cet effet
            const output = pyodide.runPython('output');

            document.getElementById("output1").textContent = output;
        }

        // Charger le code Python depuis le fichier "couleur.py"
        fetch('couleur.py')
            .then(response => response.text())
            .then(data => {
                document.getElementById('code').textContent = data;
                editor1.setValue(data);
            });

    </script>
    <script>
    const editor2 = CodeMirror(document.getElementById('editor2'), {
                value: document.getElementById('code2').value,
                mode: 'python',
                lineNumbers: true
            });

        async function runCode2() {
            // Charger Pyodide
            await loadPyodide({ indexURL: "https://cdn.jsdelivr.net/pyodide/v0.17.0/full/" });

            // Charger le code Python depuis le fichier "réflexion.py"
            const reflexionCode = await fetch('reflexion.py').then(response => response.text());

            // Mettre à jour l'éditeur avec le code chargé
            editor2.setValue(reflexionCode);

            // Exécuter le code Python
            pyodide.runPython(reflexionCode);

            // Afficher la sortie dans la balise <pre> prévue à cet effet
            const output = pyodide.runPython('output');

            // Ouvrir une nouvelle fenêtre pour afficher la sortie
            const reflexionWindow = window.open('', '_blank', 'width=800,height=600');
        }

        // Charger le code Python depuis le fichier "reflection.py"
        fetch('reflection.py')
            .then(response => response.text())
            .then(data => {
                document.getElementById('code').textContent = data;
                editor2.setValue(data);
            });
    </script>
    
</body>
</html>